


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Conjugate Gradient Solver Introduction" href="cg_intr.html" />
    <link rel="prev" title="Introduction of L1 Primitives" href="L1_overview.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis HPC Library
          

          
          </a>

          
            
            
              <div class="version">
                2021.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../pyenvguide.html">Python Environment Setup Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="L1.html">L1 Primitives User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="L1_overview.html">Introduction of L1 Primitives</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">RTM Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mathematics-in-rtm">Mathematics in RTM</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#wave-equation-and-the-finite-difference-method">1. Wave equation and the finite difference method</a></li>
<li class="toctree-l5"><a class="reference internal" href="#imaging">2. Imaging</a></li>
<li class="toctree-l5"><a class="reference internal" href="#boundary-saving-scheme">3. Boundary saving scheme</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#design-information-of-l1-primitives">Design information of L1 primitives</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#stencil2d">1. Stencil2D</a></li>
<li class="toctree-l5"><a class="reference internal" href="#rtm2d">2. RTM2D</a></li>
<li class="toctree-l5"><a class="reference internal" href="#stencil3d">3. Stencil3D</a></li>
<li class="toctree-l5"><a class="reference internal" href="#rtm3d">4. RTM3D</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cg_intr.html">Conjugate Gradient Solver Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlp_intr.html">MLP Introduction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="L1_apis.html">L1 APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="L1_test.html">L1 Test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/L2.html">L2 Kernels User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/L3.html">L3 RTM API User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmark</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../benchmark.html">Benchmark</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../_sources/user_guide/L1/rtm_intr.rst.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis HPC Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="L1.html">L1 Primitives User Guide</a> &raquo;</li>
        
          <li><a href="L1_overview.html">Introduction of L1 Primitives</a> &raquo;</li>
        
      <li>RTM Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user_guide/L1/rtm_intr.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rtm-introduction">
<span id="id1"></span><h1>RTM Introduction<a class="headerlink" href="#rtm-introduction" title="Permalink to this headline">¶</a></h1>
<p>Reverse Time Migration (RTM) is an important seismic imaging technique used
for producing an accurate representation of the subsurface.
It has been adopted by the oil and gas industry for many years.
However, the high computation demand, the high memory storage requirement
and the less cache-friendly memory access pattern present a significant
challenge.
The region under detection, in general, is a 3 dimentional field with
each direction few kilometers.
In some special situation, the problme is simplified to a 2 dimentional field by
assuming the uniformity along one direction.</p>
<div class="section" id="mathematics-in-rtm">
<h2>Mathematics in RTM<a class="headerlink" href="#mathematics-in-rtm" title="Permalink to this headline">¶</a></h2>
<div class="section" id="wave-equation-and-the-finite-difference-method">
<h3>1. Wave equation and the finite difference method<a class="headerlink" href="#wave-equation-and-the-finite-difference-method" title="Permalink to this headline">¶</a></h3>
<p><em>Equation (1)</em> is the basic mathematical equation for elastic wave propagation.</p>
<div class="math notranslate nohighlight">
\[\frac{1}{v(\mathbf{x})^2}\frac{\partial^2p(\mathbf{x}, t)}{\partial t^2} = \nabla^2 p(\mathbf{x}, t)\hspace{50mm}(1)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla^2\)</span> is the Laplace operator, <span class="math notranslate nohighlight">\(p(\mathbf{x}, t)\)</span> is the wave field and <span class="math notranslate nohighlight">\(v(\mathbf{x})\)</span> is the wave velocity.
In 2D-RTM, <span class="math notranslate nohighlight">\(\mathbf{x} = \{x, z\}\)</span>, which is the length and depth of the imaging area respectively.
In 3D-RTM, <span class="math notranslate nohighlight">\(\mathbf{x} = \{x, y, z\}\)</span>, which is the length, width and depth of the imaging area respectively.</p>
<p>Due to the non-uniform structures in the subsurface, there is no theoretical solution for <em>Equation 1</em>.
Hence, RTM is based on a numerical solution called a finite difference method.
All spacial dimensions and time domains are discretized properly.
The partial derivative with respect to time and the Laplace operator also have
corresponding transformation according to the discretization scheme.</p>
<p>For instance, the Pluto synthetic seismic velocity model which was used to evaluation our 2D-RTM implementation
has been discretized into a regular grid both spatially and temporally. The number of partiitions are listed in
<em>Table 1</em>.</p>
<table border="1" class="docutils" id="id8">
<caption><span class="caption-text">Table 1: Pluto model discretization</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Parameter</td>
<td>Length (<span class="math notranslate nohighlight">\(N_{x}\)</span>)</td>
<td>Depth (<span class="math notranslate nohighlight">\(N_{z}\)</span>)</td>
<td>Time (<span class="math notranslate nohighlight">\(N_{t}\)</span>)</td>
</tr>
<tr class="row-even"><td>No. grids</td>
<td>6960</td>
<td>1201</td>
<td>12860</td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(N_x\)</span>, <span class="math notranslate nohighlight">\(N_z\)</span>, <span class="math notranslate nohighlight">\(N_t\)</span> denote the number of grids along <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(z\)</span>, <span class="math notranslate nohighlight">\(t\)</span> respectively.</p>
<p>Similar to the approaches presented in many research publications, we also adopted Order-2 temporal scheme and Order-8 spatial scheme.
Following these discretization schemes, the 2D wave equation can be re-interpreted by <em>Equation (2) and (3)</em> shown below. <strong>Equation (2*) and (3)</strong> are for 3D RTM.</p>
<div class="math notranslate nohighlight">
\[\nabla^2p = \sum_{n=-4}^4 c_n(\frac{p(x+n\Delta x)}{\Delta x^2} + \frac{p(z+n\Delta z)}{\Delta z^2})\hspace{20mm}(2)\]</div>
<div class="math notranslate nohighlight">
\[\nabla^2p = \sum_{n=-4}^4 c_n(\frac{p(x+n\Delta x)}{\Delta x^2} + \frac{p(y+n\Delta y)}{\Delta y^2}+ \frac{p(z+n\Delta z)}{\Delta z^2})\hspace{20mm}(2*)\]</div>
<div class="math notranslate nohighlight">
\[p(t+1) = 2p(t) - p(t-1) + v^2 \Delta t^2 \nabla^2p \label{eq:temperal}\hspace{30mm}(3)\]</div>
<p>Where all <span class="math notranslate nohighlight">\(c_n\)</span> are the coeffients shown in <em>Table 2</em> below.</p>
<table border="1" class="docutils" id="id9">
<caption><span class="caption-text">Table 2: Finete Difference Method Order-8 Coefficients</span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(c_{4}\)</span>, <span class="math notranslate nohighlight">\(c_{-4}\)</span></td>
<td><span class="math notranslate nohighlight">\(c_{3}\)</span>, <span class="math notranslate nohighlight">\(c_{-3}\)</span></td>
<td><span class="math notranslate nohighlight">\(c_{2}\)</span>, <span class="math notranslate nohighlight">\(c_{-2}\)</span></td>
<td><span class="math notranslate nohighlight">\(c_{1}\)</span>, <span class="math notranslate nohighlight">\(c_{-1}\)</span></td>
<td><span class="math notranslate nohighlight">\(c_{0}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(-\frac{1}{560}\)</span></td>
<td><span class="math notranslate nohighlight">\(\frac{8}{315}\)</span></td>
<td><span class="math notranslate nohighlight">\(-\frac{1}{5}\)</span></td>
<td><span class="math notranslate nohighlight">\(\frac{8}{5}\)</span></td>
<td><span class="math notranslate nohighlight">\(-\frac{1}{560}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="imaging">
<h3>2. Imaging<a class="headerlink" href="#imaging" title="Permalink to this headline">¶</a></h3>
<p>The seismic imaging is via cross-correlation between a source wavefield and a receiver wavefield.
Mathematically, it can be expressed as <em>Equation 4</em>.</p>
<div class="math notranslate nohighlight">
\[I(\mathbf{x}) = \sum_{i=1}^{N_s}\sum_{t_n=1}^{N_t}p_s^i(\mathbf{x}, t_n)p_r^i(\mathbf{x}, t_n)\hspace{40mm}(4)\]</div>
<p>where <span class="math notranslate nohighlight">\(N_s\)</span> is the total number of shots,
<span class="math notranslate nohighlight">\(p_s^i(\mathbf{x}, t_n)\)</span> is a source wavefield
and <span class="math notranslate nohighlight">\(p_r^i(\mathbf{x}, t_n)\)</span> is a receiver wavefield.</p>
</div>
<div class="section" id="boundary-saving-scheme">
<h3>3. Boundary saving scheme<a class="headerlink" href="#boundary-saving-scheme" title="Permalink to this headline">¶</a></h3>
<p>To correctly reconstruct the source wavefield in the backward process, it is necessary to extend the boundary and
save the boundaries value in a forward process.
For 2D-RTM, there are 4 boundaries to deal with.
Dussaud <a class="footnote-reference" href="#id6" id="id2">[1]</a> et al. proposed saving half-order
length of all the 4 boundaries with absorbing boundary condition.
In this case, the reconstruction source wavefield is definitely perfect. However, a huge amount of storage is required.
In our project, we adopt the scheme proposed by Liu <a class="footnote-reference" href="#id7" id="id3">[2]</a>
which saved only half-order length of the upper boundaries’ values with absorbing boundary conditions
and used random boundary condition for the other three boundaries in order to balance the accuracy and storage requirement.</p>
</div>
</div>
<div class="section" id="design-information-of-l1-primitives">
<h2>Design information of L1 primitives<a class="headerlink" href="#design-information-of-l1-primitives" title="Permalink to this headline">¶</a></h2>
<div class="section" id="stencil2d">
<h3>1. Stencil2D<a class="headerlink" href="#stencil2d" title="Permalink to this headline">¶</a></h3>
<p>Template class <strong>Stencil2D</strong> provides the implementation of  <em>Equation (2) and (3)</em>, in which function <strong>laplacian</strong> realizes the <em>Equation (2)</em> and function <strong>propagate</strong> realizes the <em>Equation (3)</em>.
The <strong>laplacian</strong> function (also called stencil in <em>Figure 1</em>) applies line buffers and shifting registers to achieve high spatial parallism.
By assigning a value e.g. 2 to the template variable <em>t_nPE</em>,
the HLS will synthesize a compute IP with the ability to
compute the laplacian operation for 2 grid points in one clock cycle.
The <strong>propagate</strong> function (also called time upate in <em>Figure 1</em>) processes multiple data streams in parallel to compute multiple data points of the next wavefield simultaneously.</p>
</div>
<div class="section" id="rtm2d">
<h3>2. RTM2D<a class="headerlink" href="#rtm2d" title="Permalink to this headline">¶</a></h3>
<p>Template class <strong>RTM2D</strong> provides the implementation of time step iteration in 2D-RTM. In this class, function <strong>forward</strong> emulates a single time step in the forward propagation path, function <strong>backword</strong> emulates a single time step in the backward propagation path.
The boundary condition adopted here is Hybrid Boudary Condition (HBC).</p>
<div class="section" id="forward-streaming-module">
<span id="id4"></span><h4>Forward streaming module<a class="headerlink" href="#forward-streaming-module" title="Permalink to this headline">¶</a></h4>
<p>The block diagram of <strong>forward</strong> function given in <em>Figure 1</em> shows the achieved temporal parallelims, namely computing the wavefield at time step <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(t+1\)</span> simultaneouly. The streaming interfaces of the basic modules allow them to be connected directly by FIFOs, which hold the wavefield data without storing them back to external memory. This streamlined architecture is the key to achieve high parallelism both spatially and temporally. Each Forward streaming module labeled with <strong>F</strong> basically takes the wavefield data from the last time stamp then computes the wavefield for current time stamp and outputs both the data and boundary data to other modules in streams.</p>
<div class="figure align-center" id="id10">
<img alt="2D-RTM forward streaming module" src="../../_images/rtm2DStreaming.png" />
<p class="caption"><span class="caption-text">Figure 1. Forward streaming module</span></p>
<div class="legend">
Red line: data stream of wavefield <span class="math notranslate nohighlight">\(p(t)\)</span>; Blue line: data stream of velocity model <span class="math notranslate nohighlight">\(v^2 \Delta t^2\)</span>; Black line: data stream of boundaries</div>
</div>
</div>
<div class="section" id="backward-streaming-module">
<span id="id5"></span><h4>Backward streaming module<a class="headerlink" href="#backward-streaming-module" title="Permalink to this headline">¶</a></h4>
<p>As shown in <em>Figure 2</em>, the <strong>backward</strong> function is composed of three modules connected by FIFOs.
Two of them labeled with <strong>R</strong> and <strong>S</strong>, similar to the forward streaming module,
are designed to compute Receiver wavefield and reconstruct Source wavefield respectively.
The module labeled with <strong>I</strong> (Imaging streaming module) realizes <strong>Equation (4)</strong>, whic is used to compute the cross correlation between the two wavefields (Receiver and Source wavefields).</p>
<div class="figure align-center" id="id11">
<img alt="2D-RTM backward streaming module" src="../../_images/rtm2DBwdStr.png" />
<p class="caption"><span class="caption-text">Figure 2. Backward streaming module</span></p>
</div>
</div>
</div>
<div class="section" id="stencil3d">
<h3>3. Stencil3D<a class="headerlink" href="#stencil3d" title="Permalink to this headline">¶</a></h3>
<p>Similarly, the template class <strong>Stencil3D</strong> provides the implementation of  <strong>Equation (2*) and (3)</strong> by function <strong>laplacian</strong> and function <strong>propagate</strong> respectly.
The <strong>laplacian</strong> function (also called stencil in <em>Figure 1</em>) applies multiple buffers and shifting registers to achieve high spatial parallism.
By assigning values to the template variable <em>t_nPEX</em> and <em>t_nPEZ</em>,
the HLS will synthesize a compute IP with the ability to
compute the laplacian operation for multiple grid points in one clock cycle.
The <strong>propagate</strong> function (also called time upate in <em>Figure 1</em>) processes multiple data streams in parallel to compute multiple data points of the next wavefield simultaneously.</p>
</div>
<div class="section" id="rtm3d">
<h3>4. RTM3D<a class="headerlink" href="#rtm3d" title="Permalink to this headline">¶</a></h3>
<p>Similarly, template class <strong>RTM3D</strong> provides the implementation of time step iteration in 3D-RTM.
In this class, function <strong>forward</strong> emulates a single time step in the forward propagation path.
There are multiple overload of this function for various boundary conditions e.g.
Random Boudnayr Condition (RBC).</p>
<p>The block diagram of <strong>forward</strong> function given in <em>Figure 1</em> shows the achieved temporal parallelims, namely computing the wavefield at time step <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(t+1\)</span> simultaneouly. The streaming interfaces of the basic modules allow them to be connected directly by FIFOs, which hold the wavefield data without storing them back to external memory. This streamlined architecture is the key to achieve high parallelism both spatially and temporally. Each Forward streaming module labeled with <strong>F</strong> basically takes the wavefield data from the last time stamp then computes the wavefield for current time stamp and outputs both the data and boundary data to other modules in streams.</p>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>E.Dussaud,W.W.Symes,P.Williamson,L.Lemaistre,P.Singer, B. Denel, and A. Cherrett, “Computational strategies for reversetime migration,” in SEG Technical Program Expanded Abstracts 2008. Society of Exploration Geophysicists, 2008, pp. 2267– 2271.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td><ol class="first last upperalpha simple" start="8">
<li>Liu, R. Ding, L. Liu, and H. Liu, “Waveﬁeld reconstruction methods for reverse time migration,” Journal of Geophysics and Engineering, vol. 10, no. 1, p. 015004, 2012.</li>
</ol>
</td></tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cg_intr.html" class="btn btn-neutral float-right" title="Conjugate Gradient Solver Introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="L1_overview.html" class="btn btn-neutral float-left" title="Introduction of L1 Primitives" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2019, Xilinx Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>