


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Security Library
          

          
          </a>

          
            
            
              <div class="version">
                2021.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide_L1/hw_guide.html">L1 Module User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmark</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmark.html">Benchmark</a></li>
</ul>

            
			
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vitis Security Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>namespace internal</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="namespace-internal">
<span id="cid-xf-security-internal"></span><span id="doxid-namespacexf-1-1security-1-1internal"></span><span id="index-0"></span><h1>namespace internal<a class="headerlink" href="#namespace-internal" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight overview-code-block literal-block" id="cid-xf-security-internal-sm4lsh">
<span id="doxid-namespacexf-1-1security-1-1internal-1a24c39cd22e684057884eca1007aa9ad8"></span><span id="cid-xf-security-internal-sm3expand"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a87a1b8c325ecb19a7837e4673925a012"></span><span id="cid-xf-security-internal-sm3byteshift"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aab737d09983c86da41d6dc54f44a8b4b"></span><span id="cid-xf-security-internal-sm3ggj"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ac4d56030271d6adece70f1397efa6e8e"></span><span id="cid-xf-security-internal-sm3ffj"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ac79f4a7f9f0b57b9725e9ed228866d2a"></span><span id="cid-xf-security-internal-sm3tj"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a28860fecd0750c29ec649fec721bbe0f"></span><span id="cid-xf-security-internal-sm3p1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1abe1e6a3b94776ee781252b0ace45a77f"></span><span id="cid-xf-security-internal-sm3p0"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a28bcf7e550d2d86f82d64a143b14c0cf"></span><span id="cid-xf-security-internal-sm3lshd"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af8f612c5125129314e55b9befce7185b"></span><span id="cid-xf-security-internal-sm3lsh"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aab2f6992d2dbcb50b0bf03ea44eb1ba6"></span><span id="cid-xf-security-internal-sm3packing"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a6b71b92a89db7180a9789e84f53559a1"></span><span id="cid-xf-security-internal-sha3-512-40"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7015ccf12a634460487aa15811c6a544"></span><span id="cid-xf-security-internal-sha256-iter"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a68f28470de353a494647d8f5541cab76"></span><span id="cid-xf-security-internal-generatemsgschedule"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a43113e5cbfb86a2b51bfbd42e5785ff1"></span><span id="cid-xf-security-internal-dup-strm"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ace85d3a5a98e45aea9471e4ad32d000c"></span><span id="cid-xf-security-internal-ripemd160digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a5a9f813d852c349a88da9e9999060b15"></span><span id="cid-xf-security-internal-compress"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a2bfae8bb1427639149aca0a0a6da3cc1"></span><span id="cid-xf-security-internal-f-4"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa32c910fc1df3e064cedefbaaf2bc113"></span><span id="cid-xf-security-internal-f-3"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a00fb5e376d5cdf97d21d65efef90d084"></span><span id="id1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a73c61c7ee698ebf015eecaeebf6ae4fa"></span><span id="cid-xf-security-internal-f-1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a10b3e72efbdfabf087d8ef56440eb86d"></span><span id="cid-xf-security-internal-f-0"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ab63fd17c9dc5dcdb4eb542865152dd3d"></span><span id="cid-xf-security-internal-f-2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1abe6b51914046dceeab72e03b46b61079"></span><span id="cid-xf-security-internal-simplemod"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa707c82988d541e3160b19e5189ba549"></span><span id="cid-xf-security-internal-modularexp"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a0255976cd795a8615283487462ffb045"></span><span id="cid-xf-security-internal-monproduct"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ab40c49e4affd66a8cb3ecc30ca6d4fc6"></span><span id="cid-xf-security-internal-hmacdataflow"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a6bc5287898bffe970888be7e4b406282"></span><span id="cid-xf-security-internal-reshash"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a474689e939d5471d6a698875ebcd7ad4"></span><span id="cid-xf-security-internal-mergekopad"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ad12d4d24edf4450ca64cc59870b19b38"></span><span id="cid-xf-security-internal-msghash"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7a6865d617956fdcdfcb059eac559c58"></span><span id="cid-xf-security-internal-mergekipad"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a8ff7dd7315ee7ec89b2e8e5c477a30ed"></span><span id="cid-xf-security-internal-kpad"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a34967365750209195968c850b907f07a"></span><span id="cid-xf-security-internal-kpadhash"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ac663985f79f86ac9b4b76aff1f24d407"></span><span id="cid-xf-security-internal-genpad"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a9a5cd6e8b1cd6da0da07d116499af52c"></span><span id="cid-xf-security-internal-expandstrm"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a36ea38f0ccf4dde2e5f6e0905b5dcb9d"></span><span id="cid-xf-security-internal-gf128-prepare"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a4d3175d168d78d6161655cbfa694ed18"></span><span id="cid-xf-security-internal-lsh-by1-modify"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af25ef2c9f9242fd04f888b7322855b0a"></span><span id="cid-xf-security-internal-keyscheduleoriginal"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7f3b947579038787d0b257368f7305c6"></span><span id="cid-xf-security-internal-keyindexschedule"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af9c374a862fcddd2fa2e8ed0359ff8e1"></span><span id="cid-xf-security-internal-process"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af9b4876f159ad444b1099ce425916480"></span><span id="cid-xf-security-internal-finalperm"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a8e2b5924706b3291abae76e115258f1f"></span><span id="cid-xf-security-internal-initperm"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a342bfffc8e0d9e411bdd54e1d79f20fd"></span><span id="cid-xf-security-internal-f"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a2c79ef2e09d2ce329aa13765737f66f0"></span><span id="cid-xf-security-internal-perm"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a302825b34cf28fedf9c15113370bbf52"></span><span id="cid-xf-security-internal-substitute"></span><span id="doxid-namespacexf-1-1security-1-1internal-1abd21d4a2f60410fb011255f136ff520b"></span><span id="cid-xf-security-internal-extend"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7990d98e33815b92702af7564de082d2"></span><span id="cid-xf-security-internal-getsubkey"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a2c6a8ee5a0b2eded1c34f373451e2cf7"></span><span id="cid-xf-security-internal-leftrotateshift"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a3b15fc24cd072345beefcfb52e015fc8"></span><span id="cid-xf-security-internal-getsubkeyindex"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a034fdee07e4ff7ab18910949529df9da"></span><span id="cid-xf-security-internal-leftrotateshiftarray"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7e12c265157d35763e78e5ebbea23358"></span><span id="cid-xf-security-internal-initsubkeyindex"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a3e89234f159cd663ae70aebfbe268fe9"></span><span id="cid-xf-security-internal-initsubkeycd"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ace786c0c4252b6c2302970961c48c0bf"></span><span id="cid-xf-security-internal-convert"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa47565a8ef7fa4208200cc4a3812374b"></span><span id="cid-xf-security-internal-convertendian"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ab7fdb87f4700c36ad9c2d9a4968f912a"></span><span id="cid-xf-security-internal-printarray"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a3fc08762026284b9b07c50ae29a97814"></span><span id="cid-xf-security-internal-print-2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a59bd10fdfc50eec51e07152e9e45342e"></span><span id="cid-xf-security-internal-print"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ae7f958e343b6b4569a54b40f64b2ec73"></span><span id="cid-xf-security-internal-hchacha20"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a2e3fe339bbb7b7e8cc5f592d75628825"></span><span id="cid-xf-security-internal-dupstrm"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a67a18c26a25c0fe4b4f6bf14986ef54c"></span><span id="cid-xf-security-internal-digestblock"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ad4d11ee768c3d78b6525db6068e5d325"></span><span id="cid-xf-security-internal-genblock"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ae8011ec6062d32eb96a308d3a97175b8"></span><span id="cid-xf-security-internal-initblock"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a1b2818d4eb1fb61abec4aabbc6e8d419"></span><span id="cid-xf-security-internal-halfmixing2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a87d66b20717d93c607d423ae84f5fc04"></span><span id="cid-xf-security-internal-subkeyindex"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ae6d8c7068b7a9e91f171e850030261e3"></span><span id="cid-xf-security-internal-pc2map"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a618f8ee526aaf779856dd72b19c4cea5"></span><span id="cid-xf-security-internal-pcmapd"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7f5887a3851ff642c737a07a0c7c8b3b"></span><span id="cid-xf-security-internal-pcmapc"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aafee4f536f80ea933ef27c2cf228d4d5"></span><span id="cid-xf-security-internal-fpermmap"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a480b0b2a8ca5c5dca9d7908c22b24c9f"></span><span id="cid-xf-security-internal-sp"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a4a70a89514e3b4b1071e47643926b4bc"></span><span id="cid-xf-security-internal-extmap"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a22d6c13d06629aa99cf78c3dfe802084"></span><span id="cid-xf-security-internal-ipermmap"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a9b3e7abd47c20704dfe70e06a0219e4a"></span><span id="cid-xf-security-internal-permmap"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa207faaaefd24fcf1dbeb8027b040ea1"></span><span id="cid-xf-security-internal-table"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a0d6a373ad701d379c8be7ea222d2103a"></span><span id="cid-xf-security-internal-base"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a43cfd5165cd6363dcc3c1aa885b8ae62"></span><span id="cid-xf-security-internal-blocktypechacha"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a83cb8d43028db07baa259b90bbfd40aa"></span><span></span><span class="c1">// typedefs</span>

<span class="k">typedef</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">512</span><span class="o">&gt;</span> <span class="n">blockTypeChacha</span>

<span class="c1">// structs</span>

<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_SHA256Block.html#doxid-structxf-1-1security-1-1internal-1-1-s-h-a256-block"><span class="std std-ref">SHA256Block</span></a><span></span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_blake2BlockType.html#doxid-structxf-1-1security-1-1internal-1-1blake2-block-type"><span class="std std-ref">blake2BlockType</span></a><span></span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_sha256_digest_config.html#doxid-structxf-1-1security-1-1internal-1-1sha256-digest-config-3-01true-01-4"><span class="std std-ref">sha256_digest_config &lt;true&gt;</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_sha256_digest_config-2.html#doxid-structxf-1-1security-1-1internal-1-1sha256-digest-config-3-01false-01-4"><span class="std std-ref">sha256_digest_config &lt;false&gt;</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="kt">bool</span> <span class="n">do_sha224</span><span class="o">&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_sha256_digest_config-3.html#doxid-structxf-1-1security-1-1internal-1-1sha256-digest-config"><span class="std std-ref">sha256_digest_config</span></a><span></span>

<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_sm3BlkPack.html#doxid-structxf-1-1security-1-1internal-1-1sm3-blk-pack"><span class="std std-ref">sm3BlkPack</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">IW</span><span class="o">&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_treeAdd.html#doxid-structxf-1-1security-1-1internal-1-1tree-add-3-01-i-w-00-010-01-4"><span class="std std-ref">treeAdd &lt;IW, 0&gt;</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">int</span> <span class="n">IW</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">NW</span>
    <span class="o">&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_internal_treeAdd-2.html#doxid-structxf-1-1security-1-1internal-1-1tree-add"><span class="std std-ref">treeAdd</span></a><span></span>

<span class="c1">// classes</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">KeyW</span><span class="o">&gt;</span>
<span class="k">class</span> <a class="reference internal" href="class_xf_security_internal_aesCbcPack.html#doxid-classxf-1-1security-1-1internal-1-1aes-cbc-pack"><span class="std std-ref">aesCbcPack</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">W</span><span class="o">&gt;</span>
<span class="k">class</span> <a class="reference internal" href="class_xf_security_internal_packBase.html#doxid-classxf-1-1security-1-1internal-1-1pack-base"><span class="std std-ref">packBase</span></a><span></span>

<span class="c1">// global variables</span>

<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">21</span><span class="o">&gt;</span> <span class="n">BASE</span><span class="p">[]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">table</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">256</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">PermMap</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">IPermMap</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">ExtMap</span><span class="p">[</span><span class="mi">48</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">SP</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">64</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_int</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">FPermMap</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">PCMapC</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">PCMapD</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">PC2Map</span><span class="p">[</span><span class="mi">48</span><span class="p">]</span>
<span class="k">const</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">subkeyIndex</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">48</span><span class="p">]</span>
</pre>
<div class="section" id="generateblock">
<span id="cid-xf-security-internal-generateblock"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ae0274be0b71386ec801f32f47dfeb0c4"></span><h2>generateBlock<a class="headerlink" href="#generateblock" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">generateBlock</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">512</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blake2BlockType.html#doxid-structxf-1-1security-1-1internal-1-1blake2-block-type"><span class="std std-ref">blake2BlockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_len_out_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_len_out_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 1024-bit processing blocks by padding (pipeline).</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”. The optimization goal of this function is to yield a 1024-bit block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>Bit width of the message words in block, default value is 64.</td>
</tr>
<tr class="row-even"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>msg_len_strm</td>
<td>Message length in byte (0 &lt;= msg_len &lt;= 2^128).</td>
</tr>
<tr class="row-even"><td>key_strm</td>
<td>The optional key.</td>
</tr>
<tr class="row-odd"><td>key_len_strm</td>
<td>Key length in byte (0 &lt;= key_len &lt;= 64).</td>
</tr>
<tr class="row-even"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>blk_strm</td>
<td>The 1024-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-even"><td>msg_len_out_strm</td>
<td>Message length pass on to the digest process.</td>
</tr>
<tr class="row-odd"><td>key_len_out_strm</td>
<td>Key length pass on to the digest process.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rotr">
<span id="cid-xf-security-internal-rotr"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ab629a529665ce5c061996f3c87337712"></span><h2>ROTR<a class="headerlink" href="#rotr" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTR</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of rotate right (circular right shift) operation.</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="g">
<span id="cid-xf-security-internal-g"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a5b6a914884a87d4594f97c43b4618172"></span><h2>G<a class="headerlink" href="#g" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">G</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">v</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">y</span>
    <span class="p">)</span>
</pre>
<p>Mixing function G as defined in standard.</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit</td>
<td>width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>v</td>
<td>Working vector.</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>The first index.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second index.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third index.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>the fourth index.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>The first input working word.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second input working word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="compress">
<span id="cid-xf-security-internal-compress-2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ad66299eca6a07b021b1c8796c548ba5b"></span><h2>Compress<a class="headerlink" href="#compress" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">Compress</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">h</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">m</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span> <span class="n">t</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">last</span>
    <span class="p">)</span>
</pre>
<p>Compression function F as defined in standard.</p>
<p>The optimization goal of this function is for better performance. The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>Bit width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>round</td>
<td>Number of rounds, 12 for BLAKE2b and 10 for BLAKE2s.</td>
</tr>
<tr class="row-odd"><td>h</td>
<td>State vector.</td>
</tr>
<tr class="row-even"><td>m</td>
<td>Message block vector.</td>
</tr>
<tr class="row-odd"><td>t</td>
<td>Offset counter.</td>
</tr>
<tr class="row-even"><td>last</td>
<td>Final block indicator.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="blake2bdigest">
<span id="cid-xf-security-internal-blake2bdigest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a94fc7ab745161d21b09ddb5c1cb86d87"></span><h2>blake2bDigest<a class="headerlink" href="#blake2bdigest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">blake2bDigest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blake2BlockType.html#doxid-structxf-1-1security-1-1internal-1-1blake2-block-type"><span class="std std-ref">blake2BlockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">out_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">512</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the digest prcoess of BLAKE2.</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”. The optimization goal of this function is for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>Bit width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-odd"><td>key_len_strm</td>
<td>Key length in byte (0 &lt;= key_len &lt;= 64).</td>
</tr>
<tr class="row-even"><td>msg_len_strm</td>
<td>Message length in byte (0 &lt;= msg_len &lt;= 2^128).</td>
</tr>
<tr class="row-odd"><td>out_len_strm</td>
<td>Result hash value length in byte (0 &lt; out_len &lt; 64).</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>The full digest stream (result is stored in the lower out_len bytes).</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>Flag to signal the end of the result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescbcencrypt">
<span id="cid-xf-security-internal-aescbcencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa20ff3afa837928f0821820c0d9b1c10"></span><h2>aesCbcEncrypt<a class="headerlink" href="#aescbcencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cbc.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCbcEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCbcEncrypt is CBC encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescbcdecrypt">
<span id="cid-xf-security-internal-aescbcdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a97d6b271a6777290d6f5a1164088fb8d"></span><h2>aesCbcDecrypt<a class="headerlink" href="#aescbcdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cbc.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCbcDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCbcDecrypt is CBC decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="formatting">
<span id="cid-xf-security-internal-formatting"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a1858186abc155412feb321b14fd741b4"></span><h2>formatting<a class="headerlink" href="#formatting" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">formatting</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">blockStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outLenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outNonceStrm</span>
    <span class="p">)</span>
</pre>
<p>Impletmentation of formatting function as specified in standard.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-odd"><td>ADStrm</td>
<td>Associated data stream.</td>
</tr>
<tr class="row-even"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-odd"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-odd"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-even"><td>blockStrm</td>
<td>Block stream of the formatted input as specified in reference.</td>
</tr>
<tr class="row-odd"><td>outLenADStrm</td>
<td>Pass on the length of associated data to CBC-MAC.</td>
</tr>
<tr class="row-even"><td>outNonceStrm</td>
<td>Pass on the nonce to CTR.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesctrencrypt">
<span id="cid-xf-security-internal-aesctrencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7c4e08767653e7b46563bdc75e342380"></span><h2>aesCtrEncrypt<a class="headerlink" href="#aesctrencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outPayloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outCipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">S0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span>
    <span class="p">)</span>
</pre>
<p>Implementation of CTR encryption part in CCM.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-even"><td>_keyWidth</td>
<td>Bit-width of the cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-odd"><td>payloadStrm</td>
<td>Input block stream text to be encrypted.</td>
</tr>
<tr class="row-even"><td>cipherkeyStrm</td>
<td>Input cipher key used in encryption.</td>
</tr>
<tr class="row-odd"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-odd"><td>endLenPldStrm</td>
<td>Flag to signal the end of the payload length stream.</td>
</tr>
<tr class="row-even"><td>outPayloadStrm</td>
<td>Pass on the payload stream to CBC-MAC.</td>
</tr>
<tr class="row-odd"><td>outCipherkeyStrm</td>
<td>Pass on the cipherkey to CBC-MAC.</td>
</tr>
<tr class="row-even"><td>S0Strm</td>
<td>First cipher used to generate the MAC.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output encrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesctrdecrypt">
<span id="cid-xf-security-internal-aesctrdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af069376c8dd5b70c61de57d192661c5d"></span><h2>aesCtrDecrypt<a class="headerlink" href="#aesctrdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outPayloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outCipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">S0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span>
    <span class="p">)</span>
</pre>
<p>Implementation of CTR decryption part in CCM.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-even"><td>_keyWidth</td>
<td>Bit-width of the cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-odd"><td>payloadStrm</td>
<td>Input block stream text to be decrypted.</td>
</tr>
<tr class="row-even"><td>cipherkeyStrm</td>
<td>Input cipher key used in decryption.</td>
</tr>
<tr class="row-odd"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-odd"><td>endLenPldStrm</td>
<td>Flag to signal the end of the payload length stream.</td>
</tr>
<tr class="row-even"><td>outPayloadStrm</td>
<td>Pass on the payload stream to CBC-MAC.</td>
</tr>
<tr class="row-odd"><td>outCipherkeyStrm</td>
<td>Pass on the cipherkey to CBC-MAC.</td>
</tr>
<tr class="row-even"><td>S0Strm</td>
<td>First cipher used to generate the MAC.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output decrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cbc-mac">
<span id="cid-xf-security-internal-cbc-mac"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a0a4bf33a07c3b174a4ed95702a61070f"></span><h2>CBC_MAC<a class="headerlink" href="#cbc-mac" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">CBC_MAC</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">blockStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">S0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">_t</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>Impletmentation of CBC-MAC in CCM.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_keyWidth</td>
<td>Bit-width of the cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-odd"><td>payloadStrm</td>
<td>Input block stream text.</td>
</tr>
<tr class="row-even"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>blockStrm</td>
<td>Block stream of the formatted input as specified in reference.</td>
</tr>
<tr class="row-odd"><td>cipherkeyStrm</td>
<td>Input cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-even"><td>S0Strm</td>
<td>First cipher used to generate the MAC.</td>
</tr>
<tr class="row-odd"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-even"><td>tagStrm</td>
<td>The MAC.</td>
</tr>
<tr class="row-odd"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesccmencrypt">
<span id="cid-xf-security-internal-aesccmencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ab1510ff1737abe233984a61ac06379dc"></span><h2>aesCcmEncrypt<a class="headerlink" href="#aesccmencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCcmEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">_t</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>aesCcmEncrypt is CCM encryption mode with AES single block cipher.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>payloadStrm</td>
<td>Input block stream text to be encrypted.</td>
</tr>
<tr class="row-odd"><td>cipherkeyStrm</td>
<td>Input cipher key used in encryption.</td>
</tr>
<tr class="row-even"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-odd"><td>ADStrm</td>
<td>Associated data stream.</td>
</tr>
<tr class="row-even"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output encrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
<tr class="row-odd"><td>tagStrm</td>
<td>The MAC stream.</td>
</tr>
<tr class="row-even"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesccmdecrypt">
<span id="cid-xf-security-internal-aesccmdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa5a9189f1cc517bdb6ee203ee66078b4"></span><h2>aesCcmDecrypt<a class="headerlink" href="#aesccmdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCcmDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">_t</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>aesCcmDecrypt is CCM decryption mode with AES single block cipher.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>payloadStrm</td>
<td>Input block stream text to be decrypted.</td>
</tr>
<tr class="row-odd"><td>cipherkeyStrm</td>
<td>Input cipher key used in decryption.</td>
</tr>
<tr class="row-even"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-odd"><td>ADStrm</td>
<td>Associated data stream.</td>
</tr>
<tr class="row-even"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output decrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
<tr class="row-odd"><td>tagStrm</td>
<td>The MAC stream.</td>
</tr>
<tr class="row-even"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb1encrypt">
<span id="cid-xf-security-internal-aescfb1encrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aa3227e5c41321815a6dce78ff65fe44d"></span><h2>aesCfb1Encrypt<a class="headerlink" href="#aescfb1encrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb1Encrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb1Encrypt is CFB1 encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb1decrypt">
<span id="cid-xf-security-internal-aescfb1decrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a8bfd4b74cf11e16aa37b36208260d804"></span><h2>aesCfb1Decrypt<a class="headerlink" href="#aescfb1decrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb1Decrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb1Decrypt is CFB1 decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb8encrypt">
<span id="cid-xf-security-internal-aescfb8encrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a75c2b918175cafe4c972f241554ffb73"></span><h2>aesCfb8Encrypt<a class="headerlink" href="#aescfb8encrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb8Encrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb8Encrypt is CFB8 encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb8decrypt">
<span id="cid-xf-security-internal-aescfb8decrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af29f8414cce821cb0cf31b176077fb27"></span><h2>aesCfb8Decrypt<a class="headerlink" href="#aescfb8decrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb8Decrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb8Decrypt is CFB8 decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb128encrypt">
<span id="cid-xf-security-internal-aescfb128encrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a5a87830ea2cc7eb5f9f1741e75c8ce13"></span><h2>aesCfb128Encrypt<a class="headerlink" href="#aescfb128encrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb128Encrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb128Encrypt is CFB128 encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb128decrypt">
<span id="cid-xf-security-internal-aescfb128decrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a073a2466f72b9adbe557d024deb5bed8"></span><h2>aesCfb128Decrypt<a class="headerlink" href="#aescfb128decrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb128Decrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb128Decrypt is CFB128 decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="chacha20imp">
<span id="cid-xf-security-internal-chacha20imp"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a22f3d39c394824d6e66f19f3d13e90ed"></span><h2>chacha20Imp<a class="headerlink" href="#chacha20imp" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/chacha20.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">chacha20Imp</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;&gt;&amp;</span> <span class="n">keyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">counterNonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">512</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">512</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">eCipherStrm</span>
    <span class="p">)</span>
</pre>
<p>chacha20 is a function for stream ciphering</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>keyStrm</td>
<td>initail key</td>
</tr>
<tr class="row-even"><td>counterNonceStm</td>
<td>initial counter and nonce</td>
</tr>
<tr class="row-odd"><td>plainStrm</td>
<td>input plain text to be encrypted</td>
</tr>
<tr class="row-even"><td>ePlainStrm</td>
<td>the end flag of plainStrm</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>output encrypted text</td>
</tr>
<tr class="row-even"><td>eCipherStrm</td>
<td>the end flag of cipherStrm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-aesctrencrypt-2">
<span id="doxid-namespacexf-1-1security-1-1internal-1a3c5d586e4d8536d6bcfad92abadfc56e"></span><span id="id2"></span><h2>aesCtrEncrypt<a class="headerlink" href="#cid-xf-security-internal-aesctrencrypt-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ctr.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCtrEncrypt is CTR encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-aesctrdecrypt-2">
<span id="doxid-namespacexf-1-1security-1-1internal-1a63025df994addb1851f1147217b78cbb"></span><span id="id3"></span><h2>aesCtrDecrypt<a class="headerlink" href="#cid-xf-security-internal-aesctrdecrypt-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ctr.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCtrDecrypt is CTR decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="keyschedule">
<span id="cid-xf-security-internal-keyschedule"></span><span id="doxid-namespacexf-1-1security-1-1internal-1abafad92b08745206ea244df38e0dd1bf"></span><h2>keySchedule<a class="headerlink" href="#keyschedule" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/des.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">keySchedule</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">key</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">48</span><span class="o">&gt;</span> <span class="n">subkeys</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span>
    <span class="p">)</span>
</pre>
<p>keySchedule is to schedule subkeys used in DES and 3DES</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>key</td>
<td>input original key, 64 bits.</td>
</tr>
<tr class="row-even"><td>subkeys</td>
<td>output subkeys in encryption or decryption.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesecbencrypt">
<span id="cid-xf-security-internal-aesecbencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a27b954bed66fec614527d907a92f90f9"></span><h2>aesEcbEncrypt<a class="headerlink" href="#aesecbencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ecb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesEcbEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesEcbEncrypt is ECB encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesecbdecrypt">
<span id="cid-xf-security-internal-aesecbdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a2e909bf93fa35821609644411e325e55"></span><h2>aesEcbDecrypt<a class="headerlink" href="#aesecbdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ecb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesEcbDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesEcbDecrypt is ECB decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesgctrencrypt">
<span id="cid-xf-security-internal-aesgctrencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ac332c8f6229cdad9ca96422ce3a6b625"></span><h2>aesGctrEncrypt<a class="headerlink" href="#aesgctrencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gcm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesGctrEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_text_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">H_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">E_K_Y0_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext1</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_length1</span>
    <span class="p">)</span>
</pre>
<p>aesGctrEncrypt Encrypt plaintext to cihpertext.</p>
<p>The algorithm reference is: “IEEE Standard for Authenticated Encryption with Length Expansion for Storage Devices” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>plaintext</td>
<td>The plaintext stream.</td>
</tr>
<tr class="row-even"><td>plaintext_length</td>
<td>Length of plaintext in bits.</td>
</tr>
<tr class="row-odd"><td>end_text_length</td>
<td>Flag to signal the end of the text length stream.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>The cipherkey, x-bit for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_Strm</td>
<td>Initialization vector.</td>
</tr>
<tr class="row-even"><td>H_strm</td>
<td>The hash subkey passed onto genGMAC.</td>
</tr>
<tr class="row-odd"><td>E_K_Y0_strm</td>
<td>E(K,Y0) as specified in standard passed onto genGMAC.</td>
</tr>
<tr class="row-even"><td>end_length</td>
<td>End flag passed onto genGMAC.</td>
</tr>
<tr class="row-odd"><td>ciphertext</td>
<td>The ciphertext stream to output port.</td>
</tr>
<tr class="row-even"><td>ciphertext_length</td>
<td>Length of ciphertext in bits to output port.</td>
</tr>
<tr class="row-odd"><td>ciphertext1</td>
<td>The ciphertext stream to genGMAC.</td>
</tr>
<tr class="row-even"><td>ciphertext_length1</td>
<td>Length of ciphertext in bits to genGMAC.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesgctrdecrypt">
<span id="cid-xf-security-internal-aesgctrdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a8614e1d68016f9ef957c22726ebd6ffc"></span><h2>aesGctrDecrypt<a class="headerlink" href="#aesgctrdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gcm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesGctrDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_text_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">H_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">E_K_Y0_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_out</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_length_out</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_length</span>
    <span class="p">)</span>
</pre>
<p>aesGctrDecrypt Decrypt ciphertext to plainrtext.</p>
<p>The algorithm reference is: “IEEE Standard for Authenticated Encryption with Length Expansion for Storage Devices” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>ciphertext</td>
<td>The ciphertext stream.</td>
</tr>
<tr class="row-even"><td>ciphertext_length</td>
<td>Length of ciphertext in bits.</td>
</tr>
<tr class="row-odd"><td>end_text_length</td>
<td>Flag to signal the end of the text length stream.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>The cipherkey, x-bit for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_Strm</td>
<td>Initialization vector.</td>
</tr>
<tr class="row-even"><td>H_strm</td>
<td>The hash subkey passed onto genGMAC.</td>
</tr>
<tr class="row-odd"><td>E_K_Y0_strm</td>
<td>E(K,Y0) as specified in standard passed onto genGMAC.</td>
</tr>
<tr class="row-even"><td>end_length</td>
<td>End flag passed onto genGMAC.</td>
</tr>
<tr class="row-odd"><td>ciphertext_out</td>
<td>The ciphertext stream passed onto genGMAC.</td>
</tr>
<tr class="row-even"><td>ciphertext_length_out</td>
<td>Length of ciphertext in bits passed onto genGMAC.</td>
</tr>
<tr class="row-odd"><td>plaintext</td>
<td>The plaintext stream.</td>
</tr>
<tr class="row-even"><td>plaintext_length</td>
<td>Length of plaintext in bits.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesgcmencrypt">
<span id="cid-xf-security-internal-aesgcmencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a360ba500d52a7da39a61c0e0472077d3"></span><h2>aesGcmEncrypt<a class="headerlink" href="#aesgcmencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gcm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesGcmEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">AAD</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">AAD_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tag</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_tag</span>
    <span class="p">)</span>
</pre>
<p>aesGcmEncrypt Top of GCM encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “IEEE Standard for Authenticated Encryption with Length Expansion for Storage Devices” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_length</td>
<td>Length of plaintext in bits.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV</td>
<td>Initialization vector.</td>
</tr>
<tr class="row-even"><td>AAD</td>
<td>Additional authenticated data for calculating the tag, 128 bits.</td>
</tr>
<tr class="row-odd"><td>AAD_length</td>
<td>Length of AAD in bits.</td>
</tr>
<tr class="row-even"><td>end__length</td>
<td>Flag to signal the end of the text length stream.</td>
</tr>
<tr class="row-odd"><td>ciphertext</td>
<td>Output encrypted block stream text, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext_length</td>
<td>Length of ciphertext in bits.</td>
</tr>
<tr class="row-odd"><td>tag</td>
<td>The MAC.</td>
</tr>
<tr class="row-even"><td>end_tag</td>
<td>End flag for the MAC.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesgcmdecrypt">
<span id="cid-xf-security-internal-aesgcmdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ae1dc90fcde496c085eee3f48cd8a0bad"></span><h2>aesGcmDecrypt<a class="headerlink" href="#aesgcmdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gcm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesGcmDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">AAD</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">AAD_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_length</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tag</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_tag</span>
    <span class="p">)</span>
</pre>
<p>aesGcmDecrypt Top of GCM decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “IEEE Standard for Authenticated Encryption with Length Expansion for Storage Devices” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>ciphertext</td>
<td>Input block stream text to be decrypted, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext_length</td>
<td>Length of ciphertext in bits.</td>
</tr>
<tr class="row-odd"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-even"><td>IV</td>
<td>Initialization vector.</td>
</tr>
<tr class="row-odd"><td>AAD</td>
<td>Additional authenticated data for calculating the tag, 128 bits.</td>
</tr>
<tr class="row-even"><td>AAD_length</td>
<td>Length of AAD in bits.</td>
</tr>
<tr class="row-odd"><td>end__length</td>
<td>Flag to signal the end of the text length stream.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_length</td>
<td>Length of plaintext in bits.</td>
</tr>
<tr class="row-even"><td>tag</td>
<td>The MAC.</td>
</tr>
<tr class="row-odd"><td>end_tag</td>
<td>End flag for the MAC.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gf128-mult">
<span id="cid-xf-security-internal-gf128-mult"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a33b60f33001cabd1b1c6aec8d0fa3a55"></span><h2>GF128_mult<a class="headerlink" href="#gf128-mult" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gmac.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">GF128_mult</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&amp;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_int</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span> <span class="n">AAD</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span> <span class="n">Y</span> <span class="p">[</span><span class="mi">128</span><span class="p">]</span>
    <span class="p">)</span>
</pre>
<p>Optimized version of multiplication in GF(2^128)</p>
<p>Because in call of GF128_mult_origin within a loop, the input Y is fixed. So we pre-calculate Y^n in GF(2^128) with GF128_prepare(). This will reduce II in genGMAC from 23 to 1</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>X</td>
<td>The first operand.</td>
</tr>
<tr class="row-even"><td>Y</td>
<td>The second operand.</td>
</tr>
<tr class="row-odd"><td>Z</td>
<td>The product.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pregmac">
<span id="cid-xf-security-internal-pregmac"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a0ea57ed3465e188f9ce065e260031b68"></span><h2>preGMAC<a class="headerlink" href="#pregmac" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gmac.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">preGMAC</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IVStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">HStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">EKY0Strm</span>
    <span class="p">)</span>
</pre>
<p>preGMAC generates H and E_K_Y0 based on AES block cipher.</p>
<p>The algorithm reference is: “IEEE Standard for Authenticated Encryption with Length Expansion for Storage
Devices” The implementation is modified for less resource utilizations while having a reasonable latency.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipherkey.</td>
</tr>
<tr class="row-even"><td>cipherkeyStrm</td>
<td>Input cipherkey, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IVStrm</td>
<td>Initialization vector for the fisrt iteration of AES encrypition.</td>
</tr>
<tr class="row-even"><td>HStrm</td>
<td>The hash key.</td>
</tr>
<tr class="row-odd"><td>EKY0Strm</td>
<td>E(K, Y0) as specified in the standard.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of the payload stream (hard-code to zero).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gengmac">
<span id="cid-xf-security-internal-gengmac"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a36fc909d574969339566a69462ea4cac"></span><h2>genGMAC<a class="headerlink" href="#gengmac" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gengmac-overload-1">
<h3>genGMAC overload (1)<a class="headerlink" href="#gengmac-overload-1" title="Permalink to this headline">¶</a></h3>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gmac.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">genGMAC</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">AADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenAADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">pldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">HStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">EKY0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>genGMAC This function calculates the MAC using AAD and payload streams. This overload is used by GCM.</p>
<p>The algorithm reference is: “IEEE Standard for Authenticated Encryption with Length Expansion for Storage Devices” The implementation is modified for less resource utilizations while having a reasonable latency.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>AADStrm</td>
<td>Additional authenticated data stream.</td>
</tr>
<tr class="row-even"><td>lenAADStrm</td>
<td>Length of AAD in bits.</td>
</tr>
<tr class="row-odd"><td>pldStrm</td>
<td>Payload stream.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of the payload in bits.</td>
</tr>
<tr class="row-odd"><td>HStrm</td>
<td>The hash key.</td>
</tr>
<tr class="row-even"><td>EKY0Strm</td>
<td>E(K, Y0) as specified in the standard.</td>
</tr>
<tr class="row-odd"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-even"><td>tagStrm</td>
<td>The MAC.</td>
</tr>
<tr class="row-odd"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gengmac-overload-2">
<span id="cid-xf-security-internal-gengmac-2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ada6649b690216d60349499b16fd286e4"></span><h3>genGMAC overload (2)<a class="headerlink" href="#gengmac-overload-2" title="Permalink to this headline">¶</a></h3>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gmac.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">genGMAC</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">AADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenAADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">HStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">EKY0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span>
    <span class="p">)</span>
</pre>
<p>genGMAC This function calculates the MAC using only AAD stream. This overload is used by GMAC.</p>
<p>The algorithm reference is: “IEEE Standard for Authenticated Encryption with Length Expansion for Storage Devices” The implementation is modified for less resource utilizations while having a reasonable latency.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>AADStrm</td>
<td>Additional authenticated data stream.</td>
</tr>
<tr class="row-even"><td>lenAADStrm</td>
<td>Length of AAD in bits.</td>
</tr>
<tr class="row-odd"><td>HStrm</td>
<td>The hash key.</td>
</tr>
<tr class="row-even"><td>EKY0Strm</td>
<td>E(K, Y0) as specified in the standard.</td>
</tr>
<tr class="row-odd"><td>tagStrm</td>
<td>The MAC.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="gmactop">
<span id="cid-xf-security-internal-gmactop"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a864567a1b8ec770172461d8f55b5d708"></span><h2>gmacTop<a class="headerlink" href="#gmactop" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/gmac.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">gmacTop</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">dataStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenDataStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IVStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span>
    <span class="p">)</span>
</pre>
<p>gmac The top of GMAC.</p>
<p>Galois Message Authentication Code (GMAC) is a mechanism to provide data origin authentication.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipherkey.</td>
</tr>
<tr class="row-even"><td>dataStrm</td>
<td>Input text stream to be authenticated.</td>
</tr>
<tr class="row-odd"><td>lenDataStrm</td>
<td>The length of the data in bits.</td>
</tr>
<tr class="row-even"><td>cipherkeyStrm</td>
<td>Input cihperkey to calculate the hash subkey and E(K,Y0).</td>
</tr>
<tr class="row-odd"><td>IVStrm</td>
<td>Initialization vector.</td>
</tr>
<tr class="row-even"><td>tagStrm</td>
<td>The MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="preprocessing">
<span id="cid-xf-security-internal-preprocessing"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a705c4b0f6cf5c910039478037c5cd9f8"></span><h2>preProcessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 512-bit processing blocks by padding and appending (pipeline).</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The optimization goal of this function is to yield a 512-bit block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>The message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="f">
<span id="id4"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a769f3091655bf404184f99002a86d0d6"></span><h2>F<a class="headerlink" href="#f" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">F</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function F as defined in standard.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-g-2">
<span id="doxid-namespacexf-1-1security-1-1internal-1a80788fdc04c879bab7bccd6ac5c4cf82"></span><span id="id5"></span><h2>G<a class="headerlink" href="#cid-xf-security-internal-g-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">G</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function G as defined in standard.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="h">
<span id="cid-xf-security-internal-h"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a27f2ccba4dcafc22a834d8bf2e85ea28"></span><h2>H<a class="headerlink" href="#h" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">H</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function H as defined in standard.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rotl">
<span id="cid-xf-security-internal-rotl"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a28b460a54113f6202dd30504a56e6c3b"></span><h2>ROTL<a class="headerlink" href="#rotl" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTL</span> <span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span>
    <span class="p">)</span>
</pre>
<p>The implementation of rotate left (circular left shift) operation.</p>
<p>The implementation of rotate left (circular left shift) operation. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 32.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
<tr class="row-even"><td>w</td>
<td>The bit width of input x, default value is 32.</td>
</tr>
<tr class="row-odd"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>Word to be rotated.</td>
</tr>
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 32.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4round1">
<span id="cid-xf-security-internal-md4round1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a447cb08b65625afefc6ca616df2280b4"></span><h2>MD4Round1<a class="headerlink" href="#md4round1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Round1</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 1.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The operation is defined as : a = (a + F(b, c, d) + X[k]) &lt;&lt;&lt; s.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4round2">
<span id="cid-xf-security-internal-md4round2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a63d63385dd9767aae7bc05da5400a4fe"></span><h2>MD4Round2<a class="headerlink" href="#md4round2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Round2</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 2.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The operation is defined as : a = (a + G(b, c, d) + X[k] + 0x5a827999) &lt;&lt;&lt; s</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4round3">
<span id="cid-xf-security-internal-md4round3"></span><span id="doxid-namespacexf-1-1security-1-1internal-1af578168eb1622fb0c7fa436df90e57a8"></span><h2>MD4Round3<a class="headerlink" href="#md4round3" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Round3</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 3.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The operation is defined as : a = (a + H(b, c, d) + X[k] + 0x6ed9eba1) &lt;&lt;&lt; s</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4digest">
<span id="cid-xf-security-internal-md4digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ad7f941696a072cb73fac5268a241f591"></span><h2>MD4Digest<a class="headerlink" href="#md4digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the digest part of MD4.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The optimization goal of this function is for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>The digest (fingerprint) stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>Flag to signal the end of the result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="i">
<span id="cid-xf-security-internal-i"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a279960b29ee7e7bc81f635661723d739"></span><h2>I<a class="headerlink" href="#i" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">I</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function I as defined in standard.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round1">
<span id="cid-xf-security-internal-md5round1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7be9fa59ca54cd1afb2a14ed78f9e360"></span><h2>MD5Round1<a class="headerlink" href="#md5round1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round1</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 1.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + F(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round2">
<span id="cid-xf-security-internal-md5round2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aeed154eaefe63a02b0bdd3b91626db5c"></span><h2>MD5Round2<a class="headerlink" href="#md5round2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round2</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 2.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + G(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round3">
<span id="cid-xf-security-internal-md5round3"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a4538f64acd2afaf449c1a2726ec65068"></span><h2>MD5Round3<a class="headerlink" href="#md5round3" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round3</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 3.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + H(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round4">
<span id="cid-xf-security-internal-md5round4"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a9c2ba71f7282beac749e0e8b92d2b6a9"></span><h2>MD5Round4<a class="headerlink" href="#md5round4" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round4</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 4.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + I(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5digest">
<span id="cid-xf-security-internal-md5digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1adb6fa2324d26a693a7a5c32ad5f04846"></span><h2>MD5Digest<a class="headerlink" href="#md5digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the digest part of MD5.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The optimization goal of this function is for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>The digest (fingerprint) stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>Flag to signal the end of the result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="productmod">
<span id="cid-xf-security-internal-productmod"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a03ccf74d5b5eb01a934f3a27b5470d3e"></span><h2>productMod<a class="headerlink" href="#productmod" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/modular.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">productMod</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opA</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opB</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opM</span>
    <span class="p">)</span>
</pre>
<p>return (opA * opB) mod opM</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>N</td>
<td>bit width of opA, opB and opM</td>
</tr>
<tr class="row-even"><td>opA</td>
<td>Product input, should be less than opM</td>
</tr>
<tr class="row-odd"><td>opB</td>
<td>Product input, should be less than opM</td>
</tr>
<tr class="row-even"><td>opM</td>
<td>Modulus, should be larger than 2^(N-1)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="addmod">
<span id="cid-xf-security-internal-addmod"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a762f76c3c169d2b2007249005b33c512"></span><h2>addMod<a class="headerlink" href="#addmod" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/modular.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">addMod</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opA</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opB</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opM</span>
    <span class="p">)</span>
</pre>
<p>return (opA + opB) mod opM</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>N</td>
<td>bit width of opA, opB and opM</td>
</tr>
<tr class="row-even"><td>opA</td>
<td>Product input, should be less than opM</td>
</tr>
<tr class="row-odd"><td>opB</td>
<td>Product input, should be less than opM</td>
</tr>
<tr class="row-even"><td>opM</td>
<td>Modulus</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="submod">
<span id="cid-xf-security-internal-submod"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a033bc5a6833a7ac37eba5570c0698bcc"></span><h2>subMod<a class="headerlink" href="#submod" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/modular.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">subMod</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opA</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opB</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opM</span>
    <span class="p">)</span>
</pre>
<p>return (opA - opB) mod opM</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>N</td>
<td>bit width of opA, opB and opM</td>
</tr>
<tr class="row-even"><td>opA</td>
<td>Product input, should be less than opM</td>
</tr>
<tr class="row-odd"><td>opB</td>
<td>Product input, should be less than opM</td>
</tr>
<tr class="row-even"><td>opM</td>
<td>Modulus</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="moninv">
<span id="cid-xf-security-internal-moninv"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ab0bf6ebf669ece24b761a0cdf652cd76"></span><h2>monInv<a class="headerlink" href="#moninv" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/modular.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">monInv</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opA</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opM</span>
    <span class="p">)</span>
</pre>
<p>return montgomery inverse of opA Reference: “The Montgomery Modular Inverse - Revisited” by E Savas, CK Koç</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>N</td>
<td>bit width of opA and opM</td>
</tr>
<tr class="row-even"><td>opA</td>
<td>Input of modular inverse.</td>
</tr>
<tr class="row-odd"><td>opM</td>
<td>Modulus of modular inverse.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="modularinv">
<span id="cid-xf-security-internal-modularinv"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aada821613ea4806850c90799ca007be0"></span><h2>modularInv<a class="headerlink" href="#modularinv" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/modular.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">modularInv</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opA</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">opM</span>
    <span class="p">)</span>
</pre>
<p>return modular inverse of opA Reference: “The Montgomery Modular Inverse - Revisited” by E Savas, CK Koç</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>N</td>
<td>bit width of opA and opM, opM should no less than 2^(N-1)</td>
</tr>
<tr class="row-even"><td>opA</td>
<td>Input of modular inverse. opA should be non-zero, might need extra checking</td>
</tr>
<tr class="row-odd"><td>opM</td>
<td>Modulus of modular inverse.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesofbencrypt">
<span id="cid-xf-security-internal-aesofbencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1ac7dd37fc2009e4db99ac439f3b93a0a4"></span><h2>aesOfbEncrypt<a class="headerlink" href="#aesofbencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ofb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesOfbEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesOfbEncrypt is OFB encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesofbdecrypt">
<span id="cid-xf-security-internal-aesofbdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a9a019c5bebf9b17db958096627d10377"></span><h2>aesOfbDecrypt<a class="headerlink" href="#aesofbdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ofb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesOfbDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesOfbDecrypt is OFB decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="multoperator">
<span id="cid-xf-security-internal-multoperator"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aba4bbcf1fe85428ca4cc127a1029ef89"></span><h2>multOperator<a class="headerlink" href="#multoperator" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/poly1305.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">260</span><span class="o">&gt;</span> <span class="n">multOperator</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">132</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span> <span class="n">B</span>
    <span class="p">)</span>
</pre>
<p>The implementation of large bit-width multiplication, the result is A * B. The optimization goal of this function to improve timing.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>A</td>
<td>The input multiplicand.</td>
</tr>
<tr class="row-even"><td>B</td>
<td>The input multiplier.</td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>The output product.</p>
</div>
<div class="section" id="resoperator">
<span id="cid-xf-security-internal-resoperator"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7c8d762be57c4ab02a00717269782afa"></span><h2>resOperator<a class="headerlink" href="#resoperator" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/poly1305.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">132</span><span class="o">&gt;</span> <span class="n">resOperator</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">260</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">)</span>
</pre>
<p>The implementation of large bit-width Module Operation, the result is A % 2^130-5. The optimization goal of this function to improve timing.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>A</td>
<td>The input parameter.</td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>The output result.</p>
</div>
<div class="section" id="poly1305imp">
<span id="cid-xf-security-internal-poly1305imp"></span><span id="doxid-namespacexf-1-1security-1-1internal-1abaace3d204dddf68a65fbabb3bf08dab"></span><h2>poly1305Imp<a class="headerlink" href="#poly1305imp" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/poly1305.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">poly1305Imp</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">132</span><span class="o">&gt;&amp;</span> <span class="n">accValue</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;</span> <span class="n">keyValue</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span> <span class="n">payload</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">lenByte</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&amp;</span> <span class="n">tagValue</span>
    <span class="p">)</span>
</pre>
<p>The implementation of poly1305.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>accValue</td>
<td>The accumulator’s value, initial value is 0, followed by the last output.</td>
</tr>
<tr class="row-even"><td>keyValue</td>
<td>Corresponding message key</td>
</tr>
<tr class="row-odd"><td>payload</td>
<td>For a massage, input block stream text, 128 bits per block, less than 128 bits, high padding 0</td>
</tr>
<tr class="row-even"><td>lenByte</td>
<td>Length of a block of payload in byte.</td>
</tr>
<tr class="row-odd"><td>tagValue</td>
<td>return a 16-byte tag to to authenticate the message.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rc4imp">
<span id="cid-xf-security-internal-rc4imp"></span><span id="doxid-namespacexf-1-1security-1-1internal-1abc93ebaa0bb084eeb4b22ddbdb85d1df"></span><h2>rc4Imp<a class="headerlink" href="#rc4imp" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/rc4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">rc4Imp</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">keyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">eKeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plainStream</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePlainStream</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStream</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">eCipherStream</span>
    <span class="p">)</span>
</pre>
<p>Rc_4 is the basic function for stream ciphering keyLength defined as the number of bytes in the key and can be in the range 1&lt;= keylength &lt;=256, typically between 5 and 16, corresponding to a key length of 40-128 bits.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>keyStrm</td>
<td>initail key</td>
</tr>
<tr class="row-even"><td>eKeyStrm</td>
<td>end flag of keyStrm</td>
</tr>
<tr class="row-odd"><td>plaintStrm</td>
<td>input plain text to be encrypted</td>
</tr>
<tr class="row-even"><td>ePlaintStrm</td>
<td>the end flag of plaintStrm</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>output encrypted text</td>
</tr>
<tr class="row-even"><td>eCipherStrm</td>
<td>the end flag of cipherStrm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ch">
<span id="cid-xf-security-internal-ch"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a561f4c2d96729af77f1048e42e7fa938"></span><h2>Ch<a class="headerlink" href="#ch" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">Ch</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>The implementation of Ch(x,y,z), the sequence of logical functions of SHA-1 where 0 &lt;= t &lt;= 19. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p>The implementation of Ch(x,y,z). The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 32.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parity">
<span id="cid-xf-security-internal-parity"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a560e43fdf16a0958fdc820492b36ce42"></span><h2>Parity<a class="headerlink" href="#parity" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">Parity</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>The implementation of Parity(x,y,z), the sequence of logical functions of SHA-1 where 20 &lt;= t &lt;= 39, and 60 &lt;= t &lt;= 79. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 32.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="maj">
<span id="cid-xf-security-internal-maj"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a4c095b5014dc84b356ab523bfb3369f8"></span><h2>Maj<a class="headerlink" href="#maj" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">Maj</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>The implementation of Maj(x,y,z), the sequence of logical functions of SHA-1 where 40 &lt;= t &lt;= 59. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p>The implementation of Maj(x,y,z). The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 32.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="generatemsgschedule">
<span id="cid-xf-security-internal-generatemsgschedule-2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a152f4164349266a0d1f84ab7eca38671"></span><h2>generateMsgSchedule<a class="headerlink" href="#generatemsgschedule" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">generateMsgSchedule</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm1</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm1</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm2</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm2</span>
    <span class="p">)</span>
</pre>
<p>Generate message schedule W (80 words) in stream. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of message schedule W which defined in the standard.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>Message block stream.</td>
</tr>
<tr class="row-odd"><td>nblk_strm1</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm1</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-odd"><td>w_strm</td>
<td>The message schedule in stream.</td>
</tr>
<tr class="row-even"><td>nblk_strm2</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm2</td>
<td>End flag for number of message block stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha1digest">
<span id="cid-xf-security-internal-sha1digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a39771fe113d4318f81fbb7aea65ad5a9"></span><h2>SHA1Digest<a class="headerlink" href="#sha1digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">SHA1Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of the secure hash algorithm.</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 32.</td>
</tr>
<tr class="row-even"><td>w_strm</td>
<td>Message schedule stream.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-odd"><td>digest_strm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-even"><td>end_digest_strm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-preprocessing-2">
<span id="doxid-namespacexf-1-1security-1-1internal-1a4a3728d6079595204e737305971e5581"></span><span id="id6"></span><h2>preProcessing<a class="headerlink" href="#cid-xf-security-internal-preprocessing-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preprocessing-overload-1">
<h3>preProcessing overload (1)<a class="headerlink" href="#preprocessing-overload-1" title="Permalink to this headline">¶</a></h3>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_SHA256Block.html#doxid-structxf-1-1security-1-1internal-1-1-s-h-a256-block"><span class="std std-ref">SHA256Block</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 512bit processing blocks for SHA224/SHA256 (pipeline) with const width. The performance goal of this function is to yield a 512b block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>msg_strm</td>
<td>the message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>the message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>that flag to signal end of input.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>the 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>the number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>end flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="preprocessing-overload-2">
<span id="cid-xf-security-internal-preprocessing-3"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a2906b038718a4ff7fedf085ed68c782b"></span><h3>preProcessing overload (2)<a class="headerlink" href="#preprocessing-overload-2" title="Permalink to this headline">¶</a></h3>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_SHA256Block.html#doxid-structxf-1-1security-1-1internal-1-1-s-h-a256-block"><span class="std std-ref">SHA256Block</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 512bit processing blocks for SHA224/SHA256 (pipeline) with const width. The performance goal of this function is to yield a 512b block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>msg_strm</td>
<td>the message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>the message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>that flag to signal end of input.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>the 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>the number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>end flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="sha256digest">
<span id="cid-xf-security-internal-sha256digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1aeb54d7fbb7df339c12af0a2067e01686"></span><h2>sha256Digest<a class="headerlink" href="#sha256digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">h_width</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha256Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">h_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">hash_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_hash_strm</span>
    <span class="p">)</span>
</pre>
<p>Digest message blocks and emit final hash.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>h_width</td>
<td>the hash width(type).</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>number of message block.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>end flag for number of message block.</td>
</tr>
<tr class="row-even"><td>hash_strm</td>
<td>the hash result stream.</td>
</tr>
<tr class="row-odd"><td>end_hash_strm</td>
<td>end flag for hash result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha256-top">
<span id="cid-xf-security-internal-sha256-top"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a5dbde89f8791bcc87f2e7254298790fb"></span><h2>sha256_top<a class="headerlink" href="#sha256-top" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">int</span> <span class="n">m_width</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">h_width</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha256_top</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">m_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">h_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">hash_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_hash_strm</span>
    <span class="p">)</span>
</pre>
<p>SHA-256/224 implementation top overload for ap_uint input.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>m_width</td>
<td>the input message stream width.</td>
</tr>
<tr class="row-even"><td>h_width</td>
<td>the output hash stream width.</td>
</tr>
<tr class="row-odd"><td>msg_strm</td>
<td>the message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>the length message being hashed in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>end flag stream of input, one per message.</td>
</tr>
<tr class="row-even"><td>hash_strm</td>
<td>the result.</td>
</tr>
<tr class="row-odd"><td>end_hash_strm</td>
<td>end falg stream of output, one per hash.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-rotl-2">
<span id="doxid-namespacexf-1-1security-1-1internal-1aa21ce8d4a4ba6388e277516218e99704"></span><span id="id7"></span><h2>ROTL<a class="headerlink" href="#cid-xf-security-internal-rotl-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTL</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span>
    <span class="p">)</span>
</pre>
<p>The implementation of rotate left (circular left shift) operation. The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="keccak-f">
<span id="cid-xf-security-internal-keccak-f"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a1c5070916c0672834ec6d8687b40eb5f"></span><h2>KECCAK_f<a class="headerlink" href="#keccak-f" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">KECCAK_f</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">stateArray</span> <span class="p">[</span><span class="mi">25</span><span class="p">])</span>
</pre>
<p>The implementation of KECCAK-f permutation function.</p>
<p>The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>stateArray</td>
<td>The 5*5*64 state array defined in standard.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha3digest">
<span id="cid-xf-security-internal-sha3digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a932d6dfd234ceb84c7c75858e532f75d"></span><h2>sha3Digest<a class="headerlink" href="#sha3digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hashLen</span> <span class="o">=</span> <span class="mi">32</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha3Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endMsgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">hashLen</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digestStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endDigestStrm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of SHA-3.</p>
<p>The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>hashLen</td>
<td>The width of the digest in byte, default value is 32 (SHA3-256).</td>
</tr>
<tr class="row-even"><td>msgStrm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>msgLenStrm</td>
<td>Message length in byte.</td>
</tr>
<tr class="row-even"><td>endMsgLenStrm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>digestStrm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-even"><td>endDigestStrm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="shakexof">
<span id="cid-xf-security-internal-shakexof"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a8e7ab26fdfc7efdf42d53d28bfcc7d42"></span><h2>shakeXOF<a class="headerlink" href="#shakexof" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hashLen</span> <span class="o">=</span> <span class="mi">16</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">shakeXOF</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endMsgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">hashLen</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digestStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endDigestStrm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of SHAKE.</p>
<p>The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>hashLen</td>
<td>The width of the digest in byte, default value is 16 (SHAKE-128).</td>
</tr>
<tr class="row-even"><td>msgStrm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>msgLenStrm</td>
<td>Message length in byte.</td>
</tr>
<tr class="row-even"><td>endMsgLenStrm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>digestStrm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-even"><td>endDigestStrm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-preprocessing-4">
<span id="doxid-namespacexf-1-1security-1-1internal-1ae8c4f9e4debdd4a59eac1dc4d668772a"></span><span id="id8"></span><h2>preProcessing<a class="headerlink" href="#cid-xf-security-internal-preprocessing-4" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 1024-bit processing blocks by padding and appending (pipeline).</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The optimization goal of this function is to yield a 1024-bit block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 64.</td>
</tr>
<tr class="row-even"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>len_strm</td>
<td>The message length in byte.</td>
</tr>
<tr class="row-even"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>blk_strm</td>
<td>The 1024-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="shr">
<span id="cid-xf-security-internal-shr"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a74b541cc3b63a52cb7f088d4ded8f0c3"></span><h2>SHR<a class="headerlink" href="#shr" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">SHR</span> <span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span>
    <span class="p">)</span>
</pre>
<p>The implementation of right shift operation. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-rotr-2">
<span id="doxid-namespacexf-1-1security-1-1internal-1a337be35b988075e103c53b781fda1162"></span><span id="id9"></span><h2>ROTR<a class="headerlink" href="#cid-xf-security-internal-rotr-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTR</span> <span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span>
    <span class="p">)</span>
</pre>
<p>The implementation of rotate right (circular right shift) operation. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bsig0">
<span id="cid-xf-security-internal-bsig0"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a5d5e1808e3c4d8d35d499a817b1eef2b"></span><h2>BSIG0<a class="headerlink" href="#bsig0" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">BSIG0</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of upper-case letter sigma 0. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bsig1">
<span id="cid-xf-security-internal-bsig1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1addc7b485c6e69a242e97ca76a110189f"></span><h2>BSIG1<a class="headerlink" href="#bsig1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">BSIG1</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of upper-case letter sigma 1. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ssig0">
<span id="cid-xf-security-internal-ssig0"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a57422107350ef25bbd5ec78d5ab48ff3"></span><h2>SSIG0<a class="headerlink" href="#ssig0" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">SSIG0</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of lower-case letter sigma 0. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ssig1">
<span id="cid-xf-security-internal-ssig1"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a6938a6214214c1a41f36a30020d06c0e"></span><h2>SSIG1<a class="headerlink" href="#ssig1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">SSIG1</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of lower-case letter sigma 1. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dup-strm">
<span id="cid-xf-security-internal-dup-strm-2"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a0678f290743b71fddf7e571310f09032"></span><h2>dup_strm<a class="headerlink" href="#dup-strm" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">dup_strm</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">in_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">in_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">out1_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">out1_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">out2_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">out2_e_strm</span>
    <span class="p">)</span>
</pre>
<p>Duplicate 1 input stream to 2 output streams.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of the streams.</td>
</tr>
<tr class="row-even"><td>in_strm</td>
<td>Input stream to be duplicated.</td>
</tr>
<tr class="row-odd"><td>in_e_strm</td>
<td>End flag of input stream.</td>
</tr>
<tr class="row-even"><td>out1_strm</td>
<td>The first output stream.</td>
</tr>
<tr class="row-odd"><td>out1_e_strm</td>
<td>End flag of the first output stream.</td>
</tr>
<tr class="row-even"><td>out2_strm</td>
<td>The second output stream.</td>
</tr>
<tr class="row-odd"><td>out2_e_strm</td>
<td>End flag of the second output stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-internal-generatemsgschedule-3">
<span id="doxid-namespacexf-1-1security-1-1internal-1a42dd79a2466d3367bac9aaa571aed415"></span><span id="id10"></span><h2>generateMsgSchedule<a class="headerlink" href="#cid-xf-security-internal-generatemsgschedule-3" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">generateMsgSchedule</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_internal_blockType.html#doxid-structxf-1-1security-1-1internal-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate message schedule W (80 words) in stream. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of message schedule W which defined in the standard, default value is 64.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>Message block stream.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-odd"><td>w_strm</td>
<td>The message schedule in stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha512digest">
<span id="cid-xf-security-internal-sha512digest"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a913c48f0ab32e6f5fe3a2645dab70f46"></span><h2>SHA512Digest<a class="headerlink" href="#sha512digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hash_width</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">SHA512Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">hash_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of SHA-512.</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 64.</td>
</tr>
<tr class="row-even"><td>hash_width</td>
<td>The bit width of hash width, which depends on specific algorithm.</td>
</tr>
<tr class="row-odd"><td>w_strm</td>
<td>Message schedule stream.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha512top">
<span id="cid-xf-security-internal-sha512top"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a3010faba30736681bbaca62f7e5379df"></span><h2>sha512Top<a class="headerlink" href="#sha512top" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hash_width</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha512Top</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">hash_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>Top function of SHA-512.</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The implementation dataflows the pre-processing part and message digest part.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 64.</td>
</tr>
<tr class="row-even"><td>hash_width</td>
<td>The bit width of hash width, which depends on specific algorithm.</td>
</tr>
<tr class="row-odd"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>The message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesxtsencrypt">
<span id="cid-xf-security-internal-aesxtsencrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a7751be8e5a94f4374b2e13036663fa6c"></span><h2>aesXtsEncrypt<a class="headerlink" href="#aesxtsencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/xts.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesXtsEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e_strm</span>
    <span class="p">)</span>
</pre>
<p>aesXtsEncrypt is XTS encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “IEEE Standard for Cryptographic Protection of
Data on Block-Oriented Storage Devices” The implementation is optimized for better performance in FPGA.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext_strm</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e_strm</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>Total length of plaintext in bit, 64 bits.</td>
</tr>
<tr class="row-odd"><td>cipherkey_strm</td>
<td>Input two cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-even"><td>initialization_vector_strm</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_strm</td>
<td>Output encrypted block stream text, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext_e_strm</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesxtsdecrypt">
<span id="cid-xf-security-internal-aesxtsdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1internal-1a39dd3e9b1e0c2b69843491787c2d41d8"></span><h2>aesXtsDecrypt<a class="headerlink" href="#aesxtsdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/xts.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesXtsDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e_strm</span>
    <span class="p">)</span>
</pre>
<p>aesXtsDecrypt is XTS decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “IEEE Standard for Cryptographic Protection of
Data on Block-Oriented Storage Devices” The implementation is optimized for better performance in FPGA.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext_strm</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e_strm</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>Total length of plaintext in bit, 64 bits.</td>
</tr>
<tr class="row-odd"><td>cipherkey_strm</td>
<td>Input two cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-even"><td>initialization_vector_strm</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_strm</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext_e_strm</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2021, Xilinx
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>