


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta content="Vitis Database Library, GQE, L3, Overlay" name="keywords" />
<meta content="Vitis Database Library L3 GQE overlay user guide." name="description" />
<meta content="Document" name="xlnxdocumentclass" />
<meta content="Tutorials" name="xlnxdocumenttype" />

		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Benchmark" href="../benchmark/benchmark.html" />
    <link rel="prev" title="GQE Kernel Configuration APIs" href="kernel_config.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Database Library
          

          
          </a>

          
            
            
              <div class="version">
                2021.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Vitis Database Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design_flows.html">Design Flows</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../guide/L1.html">L1 Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="L2.html">L2 GQE Kernel User Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">L3 GQE Overlay User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-xf-database-gqe-joiner">class xf::database::gqe::Joiner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inherited-members">Inherited Members</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#joiner">Joiner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run">run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#class-xf-database-gqe-aggregator">class xf::database::gqe::Aggregator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#aggregator">Aggregator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aggregate">aggregate</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmark/benchmark.html">Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark/tpc_h.html">TPC-H Queries with GQE</a></li>
</ul>

            
			
				<h3>Versions</h3>
				<ul>
				  <li><a href=""></a></li>
				  <li><a href=""></a></li>
				  <li><a href=""></a></li>
				  <li><a href=""></a></li>
				</ul>
			
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vitis Database Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>L3 GQE Overlay User Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="l3-gqe-overlay-user-guide">
<span id="gqe-l3-guide"></span><h1>L3 GQE Overlay User Guide<a class="headerlink" href="#l3-gqe-overlay-user-guide" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>For processing dataset with TB level scale, we develop L3 API. In this layer, we provide “hash partition + hash joini/aggregate” solution to eliminate DDR size limitation.
In both join and aggregation L3 APIs, we set three stategies for different scaled datasets. In current release, user can set strategy manually according to dataset entries.
Below, we will elaborate reference for strategy setting.
..Note: Test datasets below are based on TPC-H different scale factor.</p>
<div class="section" id="class-xf-database-gqe-joiner">
<span id="cid-xf-database-gqe-joiner"></span><span id="doxid-classxf-1-1database-1-1gqe-1-1-joiner"></span><span id="index-0"></span><h2>class xf::database::gqe::Joiner<a class="headerlink" href="#class-xf-database-gqe-joiner" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight overview-code-block literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;gqe_join.hpp&quot;</span>
</pre>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<pre class="highlight overview-code-block literal-block" id="cid-xf-database-gqe-joiner-joiner">
<span id="doxid-classxf-1-1database-1-1gqe-1-1-joiner-1a77c3fddc720e9a1695412a06ef55b506"></span><span></span><span class="k">class</span> <span class="nl">Joiner</span><span class="p">:</span> <span class="k">public</span> <a class="reference internal" href="../rst_3/class_xf_database_gqe_Base.html#doxid-classxf-1-1database-1-1gqe-1-1-base"><span class="std std-ref">xf::database::gqe::Base</span></a>
</pre>
<div class="section" id="inherited-members">
<h4>Inherited Members<a class="headerlink" href="#inherited-members" title="Permalink to this headline">¶</a></h4>
<pre class="highlight overview-inherited-code-block literal-block">

</pre>
</div>
</div>
<div class="section" id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<div class="section" id="joiner">
<span id="id1"></span><span id="doxid-classxf-1-1database-1-1gqe-1-1-joiner-1a22bf68fe65d8d5f8e0a48be47f9f1ea6"></span><h4>Joiner<a class="headerlink" href="#joiner" title="Permalink to this headline">¶</a></h4>
<pre class="highlight title-code-block literal-block">
<span></span><span class="n">Joiner</span> <span class="p">(</span><a class="reference internal" href="../rst_3/class_xf_database_gqe_FpgaInit.html#doxid-classxf-1-1database-1-1gqe-1-1-fpga-init"><span class="std std-ref">FpgaInit</span></a><span></span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
</pre>
<p>construct of <a class="reference internal" href="../rst_3/class_xf_database_gqe_Joiner.html#doxid-classxf-1-1database-1-1gqe-1-1-joiner"><span class="std std-ref">Joiner</span></a> .</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>xclbin</td>
<td>xclbin path</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="run">
<span id="cid-xf-database-gqe-joiner-run"></span><span id="doxid-classxf-1-1database-1-1gqe-1-1-joiner-1a141481944b58c4dd1d7ecd41777200cb"></span><h4>run<a class="headerlink" href="#run" title="Permalink to this headline">¶</a></h4>
<pre class="highlight title-code-block literal-block">
<a class="reference internal" href="../rst_3/enum_xf_database_gqe_ErrCode.html#doxid-namespacexf-1-1database-1-1gqe-1ab8c63d2eec74d13d9f190082ca614298"><span class="std std-ref">ErrCode</span></a><span></span> <span class="n">run</span> <span class="p">(</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_Table.html#doxid-classxf-1-1database-1-1gqe-1-1-table"><span class="std std-ref">Table</span></a><span></span><span class="o">&amp;</span> <span class="n">tab_a</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filter_a</span><span class="p">,</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_Table.html#doxid-classxf-1-1database-1-1gqe-1-1-table"><span class="std std-ref">Table</span></a><span></span><span class="o">&amp;</span> <span class="n">tab_b</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filter_b</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">join_str</span><span class="p">,</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_Table.html#doxid-classxf-1-1database-1-1gqe-1-1-table"><span class="std std-ref">Table</span></a><span></span><span class="o">&amp;</span> <span class="n">tab_c</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">output_str</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">join_type</span> <span class="o">=</span> <a class="reference internal" href="../rst_3/namespace_xf_database_gqe.html#doxid-namespacexf-1-1database-1-1gqe-1a48260a37f3c58f033217c43cdfe10380a0190ab4db681e407952c182bd745834d"><span class="std std-ref">INNER_JOIN</span></a><span></span><span class="p">,</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_JoinStrategyBase.html#doxid-classxf-1-1database-1-1gqe-1-1-join-strategy-base"><span class="std std-ref">JoinStrategyBase</span></a><span></span><span class="o">*</span> <span class="n">strategyimp</span> <span class="o">=</span> <span class="k">nullptr</span>
    <span class="p">)</span>
</pre>
<p>join function.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">sptr</span> <span class="o">=</span> <span class="n">new</span> <span class="n">gqe</span><span class="p">::</span><span class="n">JoinStrategyManualSet</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">sec_o</span><span class="p">,</span> <span class="n">sec_l</span><span class="p">,</span> <span class="n">slice_num</span><span class="p">,</span> <span class="n">log_part</span><span class="p">,</span> <span class="n">cpu_aggr</span><span class="p">);</span>
<span class="n">err_code</span> <span class="o">=</span> <span class="n">bigjoin</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">tab_o</span><span class="p">,</span> <span class="s2">&quot;19940101&lt;=o_orderdate &amp;&amp; o_orderdate&lt;19950101&quot;</span><span class="p">,</span>
    <span class="n">tab_l</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;o_orderkey = l_orderkey&quot;</span><span class="p">,</span>
    <span class="n">tab_c1</span><span class="p">,</span> <span class="s2">&quot;c1=l_extendedprice, c2=l_discount, c3=o_orderdate, c4=l_orderkey&quot;</span><span class="p">,</span>
    <span class="n">gqe</span><span class="p">::</span><span class="n">INNER_JOIN</span><span class="p">,</span>
    <span class="n">sptr</span><span class="p">);</span>
<span class="n">delete</span> <span class="n">smanual</span><span class="p">;</span>
</pre></div>
</div>
<p>Input filter_a/filter_b like “19940101&lt;=o_orderdate &amp;&amp; o_orderdate&lt;19950101”, o_orderdate and o_orderdate must be exsisted colunm names in table a/b when no filter conditions, input “”</p>
<p>Input join conditions like “left_join_key_0=right_join_key_0” when enable dual key join, use comma as seperator, “left_join_key_0=right_join_key_0,left_join_key_1=right_join_key_1”</p>
<p>Output strings are like “output_c0 = tab_a_col/tab_b_col”, when contains several columns, use comma as seperator</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>tab_a</td>
<td>left table</td>
</tr>
<tr class="row-even"><td>filter_a</td>
<td>filter condition of left table</td>
</tr>
<tr class="row-odd"><td>tab_b</td>
<td>right table</td>
</tr>
<tr class="row-even"><td>filter_b</td>
<td>filter condition of right table</td>
</tr>
<tr class="row-odd"><td>join_str</td>
<td>join condition(s)</td>
</tr>
<tr class="row-even"><td>tab_c</td>
<td>result table</td>
</tr>
<tr class="row-odd"><td>output_str</td>
<td>output column mapping</td>
</tr>
<tr class="row-even"><td>join_type</td>
<td>INNER_JOIN(default) | SEMI_JOIN | ANTI_JOIN.</td>
</tr>
<tr class="row-odd"><td>strategyimp</td>
<td>pointer to an object of <a class="reference internal" href="../rst_3/class_xf_database_gqe_JoinStrategyBase.html#doxid-classxf-1-1database-1-1gqe-1-1-join-strategy-base"><span class="std std-ref">JoinStrategyBase</span></a> or its derived type.</td>
</tr>
</tbody>
</table>
<p>GQE Join L3 layer targets to processing datasets with big left/right table, all solutions are listed below:</p>
<ol class="arabic simple">
<li>solution 0: Hash Join (Build for left table + Probe for right table), only for testing small dataset.</li>
<li>solution 1: Build + Pipelined Probes</li>
<li>solution 2: Hash Partition + Hash Join (Build + Probe(s))</li>
</ol>
<p>In solution 1, build once, then do pipelined probes. This solution targets to datasets that left table is relatively small. In its processing, right table is cutted horizontay into many slices without extra overhead.
When left table size is getting larger, we swith to solution 2, in which partition kernel will join working to distribute each row into its corresponding hash partition, thus making many small hash joins.
Comparing the two methonds, although hash partition kernel introduces extra overhead in solution 2, it also decreases each slice/partition join time duo to reducing unique key ratio.</p>
<p>Considering current DDR size in U280, the experienced left table size for solution transition is about TPC-H SF20.
That is to say, when dataset scale is smaller than TPC-H SF20, we recommend using solution 1, and cutting right table into small slices with scale close to TCP-H SF1.
when dataset scale is bigger than TPC-H SF20, user can refer to the table below to determine solution 1 or solution 2.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="23%" />
<col width="19%" />
<col width="23%" />
<col width="16%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2">Left Table</td>
<td colspan="2">Right Table</td>
<td rowspan="2">solution</td>
</tr>
<tr class="row-even"><td>column num</td>
<td>scale factor</td>
<td>column num</td>
<td>scale factor</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>&lt;=8</td>
<td>3</td>
<td>&gt;20</td>
<td>1</td>
</tr>
<tr class="row-even"><td>2</td>
<td>&gt; 8</td>
<td>3</td>
<td>&gt;20</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>&lt;20</td>
<td>4</td>
<td>&gt;20</td>
<td>1</td>
</tr>
<tr class="row-even"><td>4</td>
<td>&gt;20</td>
<td>4</td>
<td>&gt;20</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>&lt;20</td>
<td>5</td>
<td>&gt;20</td>
<td>1</td>
</tr>
<tr class="row-even"><td>5</td>
<td>&gt;20</td>
<td>5</td>
<td>&gt;20</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>&lt;20</td>
<td>7</td>
<td>&gt;20</td>
<td>1</td>
</tr>
<tr class="row-even"><td>7</td>
<td>&gt;20</td>
<td>7</td>
<td>&gt;20</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>We test some cases with different input entries. After profiling performance under both solutions,
Please note that all the testing cases pay attention to dataset with right table having a large scale (&gt;=SF20).
When left/right table in different columns, kernel will show different throughputs.</p>
</div>
</div>
</div>
<div class="section" id="class-xf-database-gqe-aggregator">
<span id="cid-xf-database-gqe-aggregator"></span><span id="doxid-classxf-1-1database-1-1gqe-1-1-aggregator"></span><span id="index-1"></span><h2>class xf::database::gqe::Aggregator<a class="headerlink" href="#class-xf-database-gqe-aggregator" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight overview-code-block literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_database/gqe_aggr.hpp&quot;</span>
</pre>
<div class="section" id="id2">
<h3>Overview<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<pre class="highlight overview-code-block literal-block" id="cid-xf-database-gqe-aggregator-aggregator">
<span id="doxid-classxf-1-1database-1-1gqe-1-1-aggregator-1a5aaf25962d1d10f4a2e6b2edf64c788e"></span>
</pre>
</div>
<div class="section" id="id3">
<h3>Methods<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="section" id="aggregator">
<span id="id4"></span><span id="doxid-classxf-1-1database-1-1gqe-1-1-aggregator-1a04a196d3e3a9e31ee4db57d2548acd3b"></span><h4>Aggregator<a class="headerlink" href="#aggregator" title="Permalink to this headline">¶</a></h4>
<pre class="highlight title-code-block literal-block">
<span></span><span class="n">Aggregator</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">xclbin</span><span class="p">)</span>
</pre>
<p>construct of <a class="reference internal" href="../rst_3/class_xf_database_gqe_Aggregator.html#doxid-classxf-1-1database-1-1gqe-1-1-aggregator"><span class="std std-ref">Aggregator</span></a> .</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>xclbin</td>
<td>xclbin path</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aggregate">
<span id="cid-xf-database-gqe-aggregator-aggregate"></span><span id="doxid-classxf-1-1database-1-1gqe-1-1-aggregator-1a84e65484d5c77b5c71de28564e56e885"></span><h4>aggregate<a class="headerlink" href="#aggregate" title="Permalink to this headline">¶</a></h4>
<pre class="highlight title-code-block literal-block">
<a class="reference internal" href="../rst_3/enum_xf_database_gqe_ErrCode.html#doxid-namespacexf-1-1database-1-1gqe-1ab8c63d2eec74d13d9f190082ca614298"><span class="std std-ref">ErrCode</span></a><span></span> <span class="n">aggregate</span> <span class="p">(</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_Table.html#doxid-classxf-1-1database-1-1gqe-1-1-table"><span class="std std-ref">Table</span></a><span></span><span class="o">&amp;</span> <span class="n">tab_in</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span> <span class="o">&lt;</span><a class="reference internal" href="../rst_3/struct_xf_database_gqe_EvaluationInfo.html#doxid-structxf-1-1database-1-1gqe-1-1-evaluation-info"><span class="std std-ref">EvaluationInfo</span></a><span></span><span class="o">&gt;</span> <span class="n">evals_info</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filter_str</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">group_keys_str</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">output_str</span><span class="p">,</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_Table.html#doxid-classxf-1-1database-1-1gqe-1-1-table"><span class="std std-ref">Table</span></a><span></span><span class="o">&amp;</span> <span class="n">tab_out</span><span class="p">,</span>
    <a class="reference internal" href="../rst_3/class_xf_database_gqe_AggrStrategyBase.html#doxid-classxf-1-1database-1-1gqe-1-1-aggr-strategy-base"><span class="std std-ref">AggrStrategyBase</span></a><span></span><span class="o">*</span> <span class="n">strategyImp</span> <span class="o">=</span> <span class="k">nullptr</span>
    <span class="p">)</span>
</pre>
<p>aggregate function.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_code</span> <span class="o">=</span> <span class="n">bigaggr</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">tab_l</span><span class="p">,</span> <span class="o">//</span><span class="nb">input</span> <span class="n">table</span>
                             <span class="p">{{</span><span class="s2">&quot;l_extendedprice * (-l_discount+c2) / 100&quot;</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">}},</span>
                              <span class="p">{</span><span class="s2">&quot;l_extendedprice * (-l_discount+c2) * (l_tax+c3) / 10000&quot;</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">}}</span>
                             <span class="p">},</span> <span class="o">//</span> <span class="n">evaluation</span>
                             <span class="s2">&quot;l_shipdate&lt;=19980902&quot;</span><span class="p">,</span> <span class="o">//</span><span class="nb">filter</span>
                             <span class="s2">&quot;l_returnflag,l_linestatus&quot;</span><span class="p">,</span> <span class="o">//</span> <span class="n">group</span> <span class="n">keys</span>
                             <span class="s2">&quot;c0=l_returnflag, c1=l_linestatus,c2=sum(eval0),c3=sum(eval1)&quot;</span><span class="p">,</span> <span class="o">//</span> <span class="n">mapping</span>
                             <span class="n">tab_c</span><span class="p">,</span> <span class="o">//</span><span class="n">output</span> <span class="n">table</span>
                             <span class="n">sptr</span><span class="p">);</span> <span class="o">//</span><span class="n">strategy</span>
</pre></div>
</div>
<p>Input filter_str like “19940101&lt;=o_orderdate &amp;&amp; o_orderdate&lt;19950101”, o_orderdate and o_orderdate must be exsisted colunm names in input table when no filter conditions, input “”</p>
<p>Input evaluation information as a struct <a class="reference internal" href="../rst_3/struct_xf_database_gqe_EvaluationInfo.html#doxid-structxf-1-1database-1-1gqe-1-1-evaluation-info"><span class="std std-ref">EvaluationInfo</span></a> , creata a valid Evaluation struct using initializer list, e.g. {“l_extendedprice * (-l_discount+c2) / 100”, {0, 100}} <a class="reference internal" href="../rst_3/struct_xf_database_gqe_EvaluationInfo.html#doxid-structxf-1-1database-1-1gqe-1-1-evaluation-info"><span class="std std-ref">EvaluationInfo</span></a> has two members: evaluation string and evaluation constants. In the evaluation string, you can input a final division calculation. Divisor only supports: 10,100,1000,10000 In the evaluation constants, input a constant for each column, if no constant, like “l_extendedprice” above, input zero.</p>
<p>Input Group keys in a string, like “group_key0, group_key1”, use comma as seperator</p>
<p>Output strings are like “c0=tab_in_col1, c1=tab_in_col2”, when contains several columns, use comma as seperator</p>
<p>StrategyImp class pointer of derived class of <a class="reference internal" href="../rst_3/class_xf_database_gqe_AggrStrategyBase.html#doxid-classxf-1-1database-1-1gqe-1-1-aggr-strategy-base"><span class="std std-ref">AggrStrategyBase</span></a> .</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>tab_in</td>
<td>input table</td>
</tr>
<tr class="row-even"><td>evals_info</td>
<td>Evalutaion information</td>
</tr>
<tr class="row-odd"><td>filter_str</td>
<td>filter condition</td>
</tr>
<tr class="row-even"><td>group_keys_str</td>
<td>group keys</td>
</tr>
<tr class="row-odd"><td>out_ptr</td>
<td>output list, output1 = tab_a_col1</td>
</tr>
<tr class="row-even"><td>tab_out</td>
<td>result table</td>
</tr>
<tr class="row-odd"><td>strategyImp</td>
<td>pointer to an object of <a class="reference internal" href="../rst_3/class_xf_database_gqe_AggrStrategyBase.html#doxid-classxf-1-1database-1-1gqe-1-1-aggr-strategy-base"><span class="std std-ref">AggrStrategyBase</span></a> or its derived type.</td>
</tr>
</tbody>
</table>
<p>In GQE Aggregation L3 layer, all solutions are listed below:</p>
<ol class="arabic simple">
<li>solution 0: Hash Aggregate, only for testing small datasets.</li>
<li>solution 1: Horizontally Cut + Pipelined Hash Aggregation</li>
<li>solution 2: Hash Partition + Pipelined Hash aggregation</li>
</ol>
<p>In solution 1, first input table is horizontally cut into many slices, then do aggregation for each slice, finally merge results together.
In solution 2, first input table is hash partitioned into many hash partitions, then do aggregation for each partition (no merge in last).
Comparing the two solutions, solution 1 introduces extra overhead for CPU merging, while solution 2 added one more kernel(hash partition) execution time.
In summary, when input table has a high unique-ratio, solution 2 will be more beneficial than solution 1.
After profiling performance using inputs with different unique key ratio, we get the turning point.</p>
<a class="reference internal image-reference" href="../_images/L3_aggr_strategy.png"><img alt="Performance for different L3 strategies" class="align-center" src="../_images/L3_aggr_strategy.png" style="width: 521.6px; height: 314.40000000000003px;" /></a>
<p>In this figure, it shows when unique key number is more than <cite>180K~240K</cite>, we can switch from <cite>solution 2</cite> to <cite>soluiton 3</cite>.</p>
<p>Others:
1) Hash Partition only support max 2 keys, when grouping by more keys, use <cite>solution 2</cite>
2) In solution 1, make one slice scale close to TPC-H SF1.
3) In solution 2, make one partition scale close to TPC-H SF1.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../benchmark/benchmark.html" class="btn btn-neutral float-right" title="Benchmark" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="kernel_config.html" class="btn btn-neutral float-left" title="GQE Kernel Configuration APIs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on March 23, 2021.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2021, Xilinx
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>